<!DOCTYPE html>
<html>
<head>
	<title>Ajax Type Ahead</title>
	<style>
		.containter {
			position: absolute;
			width: 50%;
			left: 50%;
			top: 10%;
			transform: translate(-50%,0%);
			text-align: center;
		}
		#search {
			padding: 7px;
		}
		#result {
			
		}
	</style>
</head>
<body>
	<div class="containter">
		<input type="search" id="search" placeholder="city or state">
		<div id="result"></div>
	</div>
<script>
	let text = document.getElementById("search");
	let result = document.getElementById("result");
	let cityItem = document.getElementsByClassName("cityItem");
	let cities = [];
	let foundMatch = [];

	const citiesList = "https://gist.githubusercontent.com/Miserlou/c5cd8364bf9b2420bb29/raw/2bf258763cdddd704f8ffd3ea9a3e81d25e2c6f6/cities.json";

	fetch(citiesList).then(function(response){
		return response.json();
	}).then(function(data){
		cities=data;
		console.log(cities);
	});

		function findMatch() {
			clearOldSearch(result);
			console.log("foundmatch = " + foundMatch);
			let input = text.value.toLowerCase();
			let queryResult = cities.filter(function(el) {
				let x = el.city.toLowerCase();
				if(x.match(input)) {
					foundMatch.push(el);
				}
			});
			console.log(foundMatch);
			displayMatch(foundMatch);
			return true;
		}
		function displayMatch(arr){
			arr.forEach(el => {
				console.log(el);
				let innerDiv = document.createElement('div');
				innerDiv.className = "cityItem";
				result.appendChild(innerDiv);
				innerDiv.innerHTML = el.city + " " + el.population;
			});
		}
		function clearOldSearch (node) {
			foundMatch = [];
			while(node.hasChildNodes()){
				node.removeChild(result.lastChild);
			}
			return foundMatch;
		}
	text.addEventListener("keyup", findMatch);
</script>
</body>
</html>